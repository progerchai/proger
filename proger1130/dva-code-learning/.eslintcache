[{"/Users/aiyouwei/Documents/proger/progerchai/proger1130/dva-code-learning/src/index.jsx":"1","/Users/aiyouwei/Documents/proger/progerchai/proger1130/dva-code-learning/src/dva/index.jsx":"2"},{"size":914,"mtime":1606842009809,"results":"3","hashOfConfig":"4"},{"size":1960,"mtime":1606842294637,"results":"5","hashOfConfig":"4"},{"filePath":"6","messages":"7","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"8"},"s3g3ch",{"filePath":"9","messages":"10","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"11"},"/Users/aiyouwei/Documents/proger/progerchai/proger1130/dva-code-learning/src/index.jsx",["12"],"import React from \"react\";\nimport dva, { connect } from \"./dva\";\nimport { createBrowserHistory } from \"history\";\n\nlet app = dva({\n  history: createBrowserHistory(),\n});\n\napp.model({\n  namespace: \"counter\",\n  state: {\n    number: 0,\n  },\n  reducers: {\n    // 更新数据\n    updateState(state, { payload }) {\n      return { ...state, ...payload };\n    },\n    add(state) {\n      return { number: state.number + 2 };\n    },\n    [\"counter/add\"](state) {\n      // [\"counter/add\"] 这样写的原因是,getReducer还没有对 type 做处理\n      return { number: state.number + 1 };\n    },\n  },\n  subscriptions: {},\n});\n\nfunction Counter(props) {\n  return (\n    <div>\n      <div> {props.number} </div>\n      <button onClick={() => props.dispatch({ type: \"add\" })}>+</button>\n    </div>\n  );\n}\n\nlet ConnectCounter = connect((state) => state.counter)(Counter);\n\napp.router(() => <ConnectCounter />);\napp.start(\"#root\");\n","/Users/aiyouwei/Documents/proger/progerchai/proger1130/dva-code-learning/src/dva/index.jsx",["13","14"],"import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { createBrowserHistory } from \"history\";\nimport { combineReducers, createStore } from \"redux\";\nimport { Provider, connect } from \"react-redux\";\nexport { connect };\nexport default function (opts = {}) {\n  let history = opts.history || createBrowserHistory();\n  let app = {\n    _models: [],\n    model,\n    _router: null,\n    router,\n    start,\n  };\n  function model(model) {\n    let prefixModel = prefixNamespace(model);\n    app._models.push(prefixModel);\n  }\n  function router(routerConfig) {\n    app._router = routerConfig;\n  }\n  function start(container) {\n    let reducers = getReducers(app);\n    app._store = createStore(reducers);\n    ReactDOM.render(\n      <Provider store={app._store}>{app._router()}</Provider>,\n      document.querySelector(container)\n    );\n  }\n\n  return app;\n}\n\n/**\n * 将所有的model 的reducer 以namespace 为key 整合成新的reducers\n * {\n * namespace1:function(state,action){},\n * namespace2:function(state,action){}\n * }\n * @param {*} app\n */\nfunction getReducers(app) {\n  let reducers = {}; //用来合并,会传递给combineReducers\n  for (const model of app._models) {\n    // 这里的state 是这个 model 对应的分状态\n    reducers[model.namespace] = function (state = model.state || {}, action) {\n      let model_reducers = model[\"reducers\"] || {}; // 拿到一个model 的所有reducer\n      let reducer = model_reducers[action.type]; // model_reducers['counter/add'] =>  model_reducers['add']\n      if (reducer) {\n        return reducer(state, action);\n      }\n      return state;\n    };\n  }\n  return combineReducers(reducers);\n}\n\n/**\n * 把reducer 对象的属性名 加上 `namespace`\n * @param {*} m\n */\nfunction prefixNamespace(m) {\n  let reducers = m.reducers;\n  m.reducer = Object.keys(reducers).reduce((memo, key) => {\n    let newKey = `${m.namespace}/${key}`;\n    memo[newKey] = reducers[key];\n    return memo;\n  }, {});\n  return m;\n}\n",{"ruleId":"15","severity":1,"message":"16","line":22,"column":5,"nodeType":"17","messageId":"18","endLine":25,"endColumn":6,"fix":"19"},{"ruleId":"20","severity":1,"message":"21","line":7,"column":1,"nodeType":"22","endLine":33,"endColumn":2},{"ruleId":"23","severity":1,"message":"24","line":8,"column":7,"nodeType":"25","messageId":"26","endLine":8,"endColumn":14},"no-useless-computed-key","Unnecessarily computed property [\"counter/add\"] found.","Property","unnecessarilyComputedProperty",{"range":"27","text":"28"},"import/no-anonymous-default-export","Unexpected default export of anonymous function","ExportDefaultDeclaration","no-unused-vars","'history' is assigned a value but never used.","Identifier","unusedVar",[418,433],"\"counter/add\""]